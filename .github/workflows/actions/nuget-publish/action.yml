name: Nuget Publish
inputs:
  project-name:
    required: true
runs:
  using: "composite"
  steps:
    - name: Pack
      shell: bash
      run: |
        commitInfo=$(git --no-pager log -1 --format="  %n  %n### Commit Info  %nAuthor: %an  %nDate: %ai  %nHash: %C(auto)%H")
        echo $commitInfo  >>  ${{ inputs.project-name }}/PACKAGE-DESCRIPTION
        echo $commitInfo  >>  ${{ inputs.project-name }}/README.md
        echo $commitInfo  >>  ${{ inputs.project-name }}/RELEASE-NOTES.md
        dotnet pack ${{ inputs.project-name }}/${{ inputs.project-name }}.csproj --configuration Release /p:Version=${VERSION} --no-build --output .
    - name: Push
      shell: bash
      run: |
        dotnet nuget push ${{ inputs.project-name }}.${VERSION}.nupkg --skip-duplicate --api-key ${NUGET_TOKEN} --source https://api.nuget.org/v3/index.json